<Window x:Class="ZenBIM.Views.ImportExcelView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="ZenBIM Import" 
        Width="460" SizeToContent="Height"
        WindowStartupLocation="CenterScreen" 
        Topmost="False" ResizeMode="NoResize" WindowStyle="None" 
        AllowsTransparency="True" Background="Transparent">

    <Window.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="pack://application:,,,/ZenBIM;component/Resources/ZenStyles.xaml"/>
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </Window.Resources>

    <Border Background="{StaticResource GlassBackground}" CornerRadius="28" Padding="24" MouseDown="OnWindowDrag">
        <Border.Effect>
            <StaticResource ResourceKey="ZenElevation"/>
        </Border.Effect>

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="0" Margin="0,0,0,25">
                <StackPanel VerticalAlignment="Center">
                    <TextBlock FontSize="26" Foreground="{StaticResource TextDark}">
                        <Run Text="Import" FontWeight="Light"/><Run Text="Excel" FontWeight="Bold"/>
                    </TextBlock>
                    <TextBlock Text="Convert Named Ranges to Revit Schedules" FontSize="13" FontWeight="Bold" 
                               Foreground="{StaticResource ZenGradientDetails}" Margin="2,2,0,0"/>
                </StackPanel>
                <Button HorizontalAlignment="Right" VerticalAlignment="Top" Content="✕" Click="OnCloseClick" 
                        Background="Transparent" BorderThickness="0" Foreground="#999999" FontSize="16" 
                        Cursor="Hand" Width="30" Height="30"/>
            </Grid>

            <StackPanel Grid.Row="1" Margin="0,0,0,20">
                <TextBlock Text="1. SOURCE FILE" FontSize="11" FontWeight="Bold" Foreground="Black" Margin="5,0,0,8"/>
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    <Border Background="#FFFFFF" CornerRadius="12" Height="45" BorderBrush="#E0E0E0" BorderThickness="1">
                        <TextBlock x:Name="TxtPath" Text="Select Excel file..." VerticalAlignment="Center" Margin="15,0" 
                                   Foreground="#999999" FontSize="13" TextTrimming="CharacterEllipsis"/>
                    </Border>
                    <Button Grid.Column="1" Content="Browse" Click="OnBrowseClick" Margin="10,0,0,0" Width="85" Height="45" 
                            Style="{StaticResource BtnSecondary}"/>
                </Grid>
            </StackPanel>

            <StackPanel Grid.Row="2" Margin="0,0,0,20">
                <TextBlock Text="2. SELECT WORKSHEET" FontSize="11" FontWeight="Bold" Foreground="Black" Margin="5,0,0,8"/>
                <ComboBox x:Name="ComboSheets" IsEnabled="False" Height="45" VerticalContentAlignment="Center"
                          SelectionChanged="OnSheetChanged"
                          Style="{StaticResource {x:Type ComboBox}}"/>
            </StackPanel>

            <StackPanel Grid.Row="3" Margin="0,0,0,30">
                <TextBlock Text="3. SELECT NAMED RANGE" FontSize="11" FontWeight="Bold" Foreground="Black" Margin="5,0,0,8"/>

                <ComboBox x:Name="ComboRanges" IsEnabled="False" Height="45" VerticalContentAlignment="Center"
                          Style="{StaticResource {x:Type ComboBox}}"/>

                <TextBlock Text="Only named ranges belonging to the selected sheet are shown." 
                           Foreground="#999999" FontSize="11" Margin="5,8,0,0" TextWrapping="Wrap"/>
            </StackPanel>

            <StackPanel Grid.Row="4" Margin="0,0,0,10">
                <Button Click="OnImportClick" Content="GENERATE SCHEDULE" Height="55" 
                        Style="{StaticResource BtnPrimary}" Margin="0,0,0,8"/>

                <TextBlock Text="NOTE: Excel colors may not match Revit exactly. Manual adjustments might be required." 
                           Foreground="Gray" 
                           FontStyle="Italic" 
                           TextWrapping="Wrap" 
                           FontSize="10"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"
                           Margin="0,0,0,2"/>

                <TextBlock Text="(Please ensure the file is closed before generating)" 
                           Foreground="#B0B0B0" 
                           FontSize="9"
                           HorizontalAlignment="Center"
                           TextAlignment="Center"/>
            </StackPanel>
        </Grid>
    </Border>
</Window>